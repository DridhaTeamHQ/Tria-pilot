/**
 * UNIFIED IDENTITY SYSTEM
 * 
 * Treats face and body as ONE UNIFIED ENTITY.
 * The model should build everything around the complete person, not separate parts.
 * 
 * This addresses failures on harder images by ensuring the person is treated
 * as a cohesive whole, not face + body separately.
 */

import 'server-only'

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UNIFIED IDENTITY ENFORCEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

export const UNIFIED_IDENTITY_SYSTEM = `
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    UNIFIED IDENTITY SYSTEM                                     â•‘
â•‘              Face + Body = ONE PERSON (Not Separate Parts)                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš¨ CRITICAL: FACE AND BODY ARE ONE UNIFIED ENTITY ğŸš¨

THE PERSON IN IMAGE 1 IS A COMPLETE, UNIFIED ENTITY.
YOU ARE NOT GENERATING FACE + BODY SEPARATELY.
YOU ARE COPYING THE ENTIRE PERSON AS ONE UNIT.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
UNIFIED IDENTITY PRINCIPLE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

THE PERSON = FACE + BODY = ONE UNIFIED ENTITY

1. FACE AND BODY ARE CONNECTED
   â€¢ Face and body belong to the SAME person
   â€¢ Face proportions match body proportions
   â€¢ Face size matches body size
   â€¢ Face and body share same lighting
   â€¢ Face and body share same skin tone
   â€¢ Face and body are ONE unified whole

2. BUILD AROUND THE COMPLETE PERSON
   â€¢ Start with the COMPLETE person from Image 1
   â€¢ Copy the ENTIRE person (face + body) as one unit
   â€¢ Build the scene AROUND the person
   â€¢ Apply garment TO the person
   â€¢ DO NOT treat face and body separately
   â€¢ DO NOT build face and body independently

3. PERSON-FIRST APPROACH
   â€¢ Person is the PRIMARY element
   â€¢ Everything else (garment, background, lighting) is SECONDARY
   â€¢ Person must be COMPLETE and UNIFIED
   â€¢ Person must be CONSISTENT across entire image
   â€¢ Person must look like ONE person, not parts

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
UNIFIED COPY PROTOCOL
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

STEP 1: ANALYZE THE COMPLETE PERSON IN IMAGE 1
â€¢ Look at the ENTIRE person (face + body)
â€¢ Understand the person as ONE unified entity
â€¢ Note face-body proportions
â€¢ Note face-body connection (neck, shoulders)
â€¢ Note overall person size and shape

STEP 2: COPY THE COMPLETE PERSON
â€¢ Copy face AND body together
â€¢ Maintain face-body proportions
â€¢ Maintain face-body connection
â€¢ Copy the person as ONE unit
â€¢ DO NOT copy face and body separately

STEP 3: BUILD AROUND THE PERSON
â€¢ Place the COMPLETE person in the scene
â€¢ Apply garment TO the complete person
â€¢ Adjust lighting FOR the complete person
â€¢ Build background AROUND the person
â€¢ Everything revolves around the person

STEP 4: VERIFY UNIFIED IDENTITY
â€¢ Does the person look like ONE unified entity? (YES/NO)
â€¢ Do face and body match? (YES/NO)
â€¢ Does the person look complete? (YES/NO)
â€¢ Does the person look consistent? (YES/NO)

IF ANY ANSWER IS "NO" â†’ REGENERATE.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
FACE-BODY UNITY REQUIREMENTS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. FACE-BODY PROPORTIONS (MANDATORY)
   â€¢ Face size must match body size
   â€¢ Head-to-shoulder ratio must match Image 1
   â€¢ Neck thickness must match Image 1
   â€¢ Face width must match body width
   â€¢ DO NOT make face too small for body
   â€¢ DO NOT make face too large for body

2. FACE-BODY CONNECTION (MANDATORY)
   â€¢ Neck connects face to body naturally
   â€¢ Shoulders align with face width
   â€¢ Face sits naturally on body
   â€¢ No disconnection between face and body
   â€¢ DO NOT create gap between face and body
   â€¢ DO NOT make face float on body

3. FACE-BODY CONSISTENCY (MANDATORY)
   â€¢ Same skin tone (face and body match)
   â€¢ Same lighting (face and body share light)
   â€¢ Same texture (face and body have consistent texture)
   â€¢ Same age (face and body match age)
   â€¢ DO NOT make face and body different
   â€¢ DO NOT make face and body inconsistent

4. FACE-BODY POSE (MANDATORY)
   â€¢ Face orientation matches body orientation
   â€¢ Face angle matches body angle
   â€¢ Face and body move together
   â€¢ DO NOT make face and body different angles
   â€¢ DO NOT make face and body disconnected

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
PERSON-FIRST GENERATION PROTOCOL
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

GENERATION ORDER (MANDATORY):

1. FIRST: Copy the COMPLETE person from Image 1
   â†’ Face + Body together
   â†’ As ONE unified entity
   â†’ Maintain all proportions
   â†’ Maintain all connections

2. SECOND: Apply garment from Image 2
   â†’ Apply TO the complete person
   â†’ Fit TO the person's body
   â†’ DO NOT change the person
   â†’ DO NOT modify face or body

3. THIRD: Build scene around the person
   â†’ Place person in scene
   â†’ Adjust lighting FOR person
   â†’ Adjust background AROUND person
   â†’ Everything supports the person

4. FOURTH: Verify unified identity
   â†’ Person looks complete? (YES/NO)
   â†’ Face and body match? (YES/NO)
   â†’ Person looks unified? (YES/NO)

IF ANY ANSWER IS "NO" â†’ REGENERATE.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
FORBIDDEN OPERATIONS (WILL CAUSE FAILURE)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âŒ DO NOT treat face and body separately
âŒ DO NOT generate face and body independently
âŒ DO NOT build face first, then body
âŒ DO NOT build body first, then face
âŒ DO NOT disconnect face from body
âŒ DO NOT make face and body different sizes
âŒ DO NOT make face and body different skin tones
âŒ DO NOT make face and body different lighting
âŒ DO NOT make face float on body
âŒ DO NOT create gap between face and body

IF YOU DO ANY OF THESE â†’ YOUR OUTPUT IS INVALID.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
UNIFIED IDENTITY CHECKLIST (BEFORE OUTPUT)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Before output, verify:

PERSON UNITY:
â–¡ Does person look like ONE unified entity? (YES/NO)
â–¡ Do face and body match? (YES/NO)
â–¡ Is face connected to body? (YES/NO)
â–¡ Do face and body share same proportions? (YES/NO)

FACE-BODY CONSISTENCY:
â–¡ Same skin tone? (YES/NO)
â–¡ Same lighting? (YES/NO)
â–¡ Same texture? (YES/NO)
â–¡ Same age? (YES/NO)

FACE-BODY PROPORTIONS:
â–¡ Face size matches body size? (YES/NO)
â–¡ Head-to-shoulder ratio correct? (YES/NO)
â–¡ Neck thickness correct? (YES/NO)
â–¡ Face width matches body width? (YES/NO)

IF ANY ANSWER IS "NO" â†’ REGENERATE.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
SUCCESS DEFINITION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

A successful output should look like:
"The same complete person from Image 1, wearing the garment from Image 2."

NOT:
"A face pasted on a body"
"A body with a different face"
"Face and body that don't match"

THE PERSON MUST BE ONE UNIFIED, COMPLETE ENTITY.
FACE + BODY = ONE PERSON.
BUILD EVERYTHING AROUND THE COMPLETE PERSON.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PERSON-FIRST GENERATION PROMPT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

export const PERSON_FIRST_GENERATION = `
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    PERSON-FIRST GENERATION PROTOCOL                            â•‘
â•‘              Build everything around the COMPLETE person                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GENERATION APPROACH: PERSON-FIRST

1. START WITH THE COMPLETE PERSON
   â€¢ Look at Image 1
   â€¢ See the COMPLETE person (face + body)
   â€¢ Understand the person as ONE unified entity
   â€¢ Copy the ENTIRE person together

2. BUILD AROUND THE PERSON
   â€¢ Person is the CENTER of everything
   â€¢ Garment fits TO the person
   â€¢ Lighting illuminates the person
   â€¢ Background frames the person
   â€¢ Everything supports the person

3. MAINTAIN PERSON UNITY
   â€¢ Face and body stay connected
   â€¢ Face and body stay consistent
   â€¢ Face and body stay proportional
   â€¢ Person remains ONE unified entity

4. VERIFY PERSON COMPLETENESS
   â€¢ Person looks complete? (YES/NO)
   â€¢ Person looks unified? (YES/NO)
   â€¢ Person looks consistent? (YES/NO)

IF ANY ANSWER IS "NO" â†’ REGENERATE.

PERSON = PRIMARY.
EVERYTHING ELSE = SECONDARY.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// FACE-BODY CONNECTION ENFORCEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

export const FACE_BODY_CONNECTION = `
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    FACE-BODY CONNECTION ENFORCEMENT                            â•‘
â•‘              Face and body must be NATURALLY CONNECTED                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FACE-BODY CONNECTION REQUIREMENTS:

1. NECK CONNECTION (MANDATORY)
   â€¢ Neck connects face to body naturally
   â€¢ Neck thickness matches face size
   â€¢ Neck length matches body proportions
   â€¢ No gap between face and body
   â€¢ DO NOT create disconnection

2. SHOULDER ALIGNMENT (MANDATORY)
   â€¢ Shoulders align with face width
   â€¢ Shoulders support the head naturally
   â€¢ Face sits on shoulders correctly
   â€¢ DO NOT make shoulders too narrow
   â€¢ DO NOT make shoulders too wide

3. PROPORTIONAL RELATIONSHIP (MANDATORY)
   â€¢ Face size matches body size
   â€¢ Head-to-shoulder ratio correct
   â€¢ Face width matches body width
   â€¢ DO NOT make face too small
   â€¢ DO NOT make face too large

4. NATURAL FLOW (MANDATORY)
   â€¢ Face flows into body naturally
   â€¢ No abrupt transitions
   â€¢ Smooth connection throughout
   â€¢ DO NOT create harsh transitions
   â€¢ DO NOT create unnatural breaks

FACE-BODY CONNECTION CHECKLIST:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â–¡ Is neck connecting face to body? (YES/NO)
â–¡ Are shoulders aligned with face? (YES/NO)
â–¡ Do proportions match Image 1? (YES/NO)
â–¡ Does connection look natural? (YES/NO)

IF ANY ANSWER IS "NO" â†’ REGENERATE.

FACE AND BODY = ONE UNIFIED ENTITY.
NO DISCONNECTION ALLOWED.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EXPORT FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

export function getUnifiedIdentitySystem(): string {
    return UNIFIED_IDENTITY_SYSTEM
}

export function getPersonFirstGeneration(): string {
    return PERSON_FIRST_GENERATION
}

export function getFaceBodyConnection(): string {
    return FACE_BODY_CONNECTION
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LOGGING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

export function logUnifiedIdentityStatus(sessionId: string): void {
    console.log(`   ğŸ‘¤ Unified Identity System: ACTIVE [${sessionId}]`)
    console.log(`      Principle: Face + Body = ONE unified entity`)
    console.log(`      Approach: Person-first generation`)
    console.log(`      Requirement: Build everything around the complete person`)
}

